/* eslint-disable */
// biome-ignore lint: disable
// prettier-ignore

// Generated by Storm Stack
// Note: Do not edit this file manually - it will be overwritten automatically

import { colors,parseArgs,renderBanner,renderFooter } from "../../runtime/cli";
import { isMinimal } from "../../runtime/env";
import { renderUsage as renderDeleteUsage } from "./delete/usage";
import { renderUsage as renderGetUsage } from "./get/usage";
import { renderUsage as renderListUsage } from "./list/usage";
import { renderUsage as renderSetUsage } from "./set/usage";

export interface VarsPayload {
  help: boolean;
  version: boolean;
  noBanner: boolean;
}

/**
 * Renders the Variable Management virtual command usage information.
 *
 * @param mode - The render mode to use when displaying the usage information (either "full" or "minimal").
 * @returns The rendered string displaying usage information.
 */
export function renderUsage(mode: "full" | "minimal" = "full"): string {
  return `${colors.whiteBright(colors.bold("Variable Management Commands"))} 

  ${colors.gray("Commands for managing the configuration parameters in the variables store.")}

  ${colors.whiteBright(colors.bold("Usage:"))}
    examples-cli vars set <name> <value> [options]
    examples-cli vars list [options]
    examples-cli vars get <name> [options]
    examples-cli vars delete <name> [options]${
      mode === "full"
        ? `

  ${colors.whiteBright(colors.bold("Commands:"))}
${renderSetUsage("minimal")
  .split("\n")
  .map(line => `    ${line}`)
  .join("\n")}

${renderListUsage("minimal")
  .split("\n")
  .map(line => `    ${line}`)
  .join("\n")}

${renderGetUsage("minimal")
  .split("\n")
  .map(line => `    ${line}`)
  .join("\n")}

${renderDeleteUsage("minimal")
  .split("\n")
  .map(line => `    ${line}`)
  .join("\n")}`
        : ""
    }

  ${colors.whiteBright(colors.bold("Options:"))}
    --help, -h, -?  ${colors.gray("Show help information. [default: false]")} 
    --version, -v   ${colors.gray("Show the version of the application. [default: false]")} 
    --no-banner     ${colors.gray("Hide the banner displayed while running the CLI application (will be set to true if running in a CI pipeline). [default: false]")}
`;
}

/**
 * The entry point for the Variable Management virtual command.
 */
async function handler() {
  try {
    if (process.argv.length > 3) {
      const command = process.argv[2];
      if (command && !command.startsWith("-")) {
        if (command.toLowerCase() === "set") {
          const handle = await import("./set").then(m => m.default);
          return handle();
        } else if (command.toLowerCase() === "list") {
          const handle = await import("./list").then(m => m.default);
          return handle();
        } else if (command.toLowerCase() === "get") {
          const handle = await import("./get").then(m => m.default);
          return handle();
        } else if (command.toLowerCase() === "delete") {
          const handle = await import("./delete").then(m => m.default);
          return handle();
        }

        console.error(
          ` ${colors.red("✘")} ${colors.redBright(`Unknown command: ${colors.bold(command || "<none>")}`)}`
        );
        console.log("");
        console.log(renderUsage("full"));
        console.log("");
        console.log(renderFooter());
        console.log("");

        return;
      }
    }

    const args = parseArgs(process.argv.slice(2), {
      boolean: ["help", "h", "?", "version", "v", "no-banner", ""],
      alias: {
        help: ["help", "HELP", "h", "H", "?", "?"],
        version: ["version", "VERSION", "v", "V"],
        noBanner: ["no-banner", "NO-BANNER"]
      }
    });

    if (args["version"] || args["v"]) {
      console.log($storm.vars.APP_VERSION);
    } else {
      if (args["no-banner"] !== true && !isMinimal) {
        console.log(
          renderBanner(
            "Variable Management Commands",
            "Commands for managing the configuration parameters in the variables store."
          )
        );
        console.log("");
      }

      console.log(renderUsage("full"));
      console.log("");
      console.log(renderFooter());
      console.log("");
    }
  } catch (err) {
    console.error(
      ` ${colors.red("✘")} ${colors.redBright(`Error occurred while processing Variable Management command.`)}`
    );
  }
}

export default handler;
